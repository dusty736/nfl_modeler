################################################################################
# step2_schedule_process.R
################################################################################

library(arrow)
library(here)
library(dplyr)

source(here("etl", "R", "step2_schedule_process_functions.R"))

################################################################################
# Read raw file
################################################################################
schedule_raw <- arrow::read_parquet(here("data", "raw", "schedule.parquet"))

################################################################################
# Clean and normalize
################################################################################
schedule_clean <- clean_schedule_data(schedule_raw)

################################################################################
# Write to processed/
################################################################################
arrow::write_parquet(
  schedule_clean,
  here("data", "processed", "games.parquet")
)
